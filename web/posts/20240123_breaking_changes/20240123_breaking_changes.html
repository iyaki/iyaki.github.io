---
layout: blog.html
date: "2024-01-23T22:41:44.359Z"
created: "2024-01-23T22:41:44.359Z"
title: Breaking Changes
description: Breve relato sobre mi experiencia al intentar migrar mi website a eleventy sin hacer inaccesibles las antiguas URIs.
epigraph: Algunas lecciones acerca de URIs que me llevo del proceso de migración a eleventy.
tags:
  - post
---
<h1 lang="en">Breaking Changes</h1>
<p><time datetime="2024-01-23">23/01/2024</time></p>
<p>Si utilizan <abbr title="Really Simple Sindication" lang="en">RSS</abbr> para seguir los artículos que escribo en mi blog personal, es posible que a fines del 2023 se hayan encontrado con <a href="https://iyaki.ar/posts/20231217_cambios_en_feeds_rss/" target="_blank">este post</a> en el que comento algunos cambios importantes sobre mis feeds <abbr title="Really Simple Sindication" lang="en">RSS</abbr>, que acompañan la migración de mi sitio web a <a href="https://www.11ty.dev/" target="_blank" lang="en" hreflang="en">eleventy</a>.</p>
<p>Hoy vengo a contar un poco sobre como estoy gestionando estos cambios en las <span lang="en">URIs</span> de las distintas páginas de mi <span lang="en">website</span>, siempre con el objetivo de mantener la mayor retrocompatibilidad posible, evitando así <i lang="en">breaking changes</i>.</p>
<p>Al migrar a <span lang="en">eleventy</span> decidí hacer caso a los consejos de <a href="https://www.w3.org/Provider/Style/URI" target="_blank" lang="en">Cool URIs don’t change</a> y eliminar la extensión <code>.html</code> de las <span lang="en">URIs</span> de mis páginas (el cual es ademas el comportamiento predeterminado de <span lang="en">eleventy</span>). Inmediatamente, comencé a buscar una manera de mantener las antiguas <span lang="en">URIs</span> funcionando.</p>
<p>Como soy una persona de bien, que respeta el protocolo <abbr title="HyperText Transfer Protocol" lang="en">HTTP</abbr>, mi primera intención fue configurar redirecciones (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/301" target="_blank" lang="en" hreflang="en">301 - Moved Permanently</a>) para que todas las direcciones antiguas redirigiesen de forma automática a las nuevas y el cambio en las <span lang="en">URIs</span> fuese explícito y visible para los visitantes de mi web. Esta era la opción más adecuada, pero, al parecer, <a href="https://pages.github.com/" target="_blank" lang="en" hreflang="en">Github Pages</a> (<i lang="en">hosting</i> que utilizo para mi <span lang="en">website</span>) no tiene soporte para configurar redirecciones más allá del clásico <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404" target="_blank" lang="en" hreflang="en">404 - Not Found</a>.</p>
<p>Fue entonces cuando revisando los directorios y archivos de mi sitio descubrí cuál sería la primera solución que implementaría: No hacer nada. ¿Nada? ¡Sí, eso mismo!</p>
<p>El proceso de deploy de este sitio es extremadamente simple, se basa en copiar archivos de un directorio a otro. Y como todos los archivos que <span lang="en">eleventy</span> había generado, tenían rutas distintas a los originales, la primera solución resultó ser seguir sirviendo los antiguos archivos en sus <span lang="en">URIs</span> originales, teniendo así duplicados de muchas de mis páginas.</p>
<p>Esto servía para salir del paso, pero no me terminaba que convencer como solución, ya que, más pronto que tarde, estos duplicados comenzarían a diferir en contenido, generando inconsistencias. Entonces, me embarqué en la búsqueda de una solución más elegante y sostenible, la cual aún no encuentro.</p>
<p>Pero esto no significa que no haya mejorado la solución original.</p>
<p>Actualmente, he cambiado las copias de las páginas por enlaces simbólicos (<i lang="en">symlinks</i>, para los amigos). Los enlaces simbólicos me permiten tener una única versión de cada página, pero mantener accesibles las antiguas <span lang="en">URIs</span>. Esto solo resuelve el problema de la consistencia, ya que el cambio en las <span lang="en">URIs</span> sigue sin hacerse visible para los visitantes. Otro problema que todavía mantiene esta solución es el de la canonicidad de las páginas, al haber múltiples <span lang="en">URIs</span> para un mismo contenido, los motores de búsqueda como <span lang="en">Google</span> no saben cuál deberían sugerir en los resultados porque sus <i lang="en">bots</i> no tienen manera de saber que una de las direcciones corresponde a un enlace simbólico.</p>
<p>Este problema con los motores de búsqueda, de momento, lo estoy resolviendo, incluyendo, en todas las páginas, tags <abbr title="Hyper Text Markup Language">HTML</abbr> del estilo: <code>&lt;link rel=&quot;canonical&quot; href=&quot;https://iyaki.ar/blog/&quot;&gt;</code> lo que, <a href="https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls?hl=es" target="_blank">según <span lang="en">Google</span></a> debería resolver el problema.</p>
<p>Aún no termino de decidir si eventualmente debería dar de baja las direcciones antiguas de manera definitiva (Opción tentadora para simplificar el mantenimiento, sobre todo teniendo en cuenta que esta web es bastante joven y las posibilidades de que haya enlaces de terceros a sus páginas aún son muy bajos) es por esto que, de manera cautelar, he agregado en la <a href="https://iyaki.ar/404.html" target="_blank">página de 404</a> un <a href="https://blog.archive.org/2013/10/24/web-archive-404-handler-for-webmasters/" target="_blank" hreflang="en">script <abbr title="Javascript" lang="en">JS</abbr></a> del <a href="https://archive.org/" target="_blank" lang="en" hreflang="en">Internet Archive</a> que permite recomendar automáticamente páginas web guardadas con anterioridad en su base de datos en caso de no existir la dirección solicitada.</p>
<p>Además, aprovechando esta posibilidad que brinda <a href="https://web.archive.org/" target="_blank" lang="en" hreflang="en">WayBack Machine</a> del <span lang="en">Internet Archive</span>, para asegurarme de que mis posts y páginas queden almacenados, en el <span lang="en">Github Action</span> que se encarga de realizar las publicaciones agregué <del title="para mas detalles, leer las actualizaciones al final del post" cite="https://github.com/iyaki/iyaki.github.io/commit/ea6f3a745a3ecf6c740417c7be461789eaa3a00f" date="2024-05-29">una sección</del> para respaldar automáticamente el contenido de mi sitio web mediante la <abbr title="Application Programming Interface" lang="en">API</abbr> <abbr title="Representational State Transfer" lang="en">REST</abbr> que exponen.</p>
<p>Esto es todo por ahora, si tengo novedades sobre esta migración, sus ventajas y desafíos los verán en mis posts.</p>
<p lang="fr">Au revoir!</p>
<h2>Actualizaciones</h2>
<p>Durante mayo del 2024, después de varios meses de haber implementado WayBack Machine y comprobar su correcto funcionamiento he decidido, eliminar los enlaces simbólicos.</p>
<p>Esto se debe, principalmente, a que la generación de estos enlaces simbólicos complejizaba el <a href="https://github.com/iyaki/iyaki.github.io/commit/ea6f3a745a3ecf6c740417c7be461789eaa3a00f" target="_blank">nuevo proceso de deploy</a> de este sitio web.</p>
<p>También como consecuencia de los cambios del proceso de deploy fue necesario cambiar el proceso de archivado de las páginas en <span lang="en">WayBack Machine</span> del <span lang="en">Internet Archive</span> que ahora se realiza en un <a href="https://github.com/iyaki/iyaki.github.io/blob/main/.github/workflows/preserve.yml" target="_blank"><span lang="en">Github Action</span> independiente</a> y utiliza una pequeña <a href="https://github.com/iyaki/web-archiver" target="_blank" hreflang="en">aplicación que desarrollé para archivas páginas a partir de un sitemap</a>.</p>
